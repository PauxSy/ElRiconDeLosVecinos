<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Promociones</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    {% load static %}
    <link rel="stylesheet" href="{% static 'estilos.css' %}">
</head>
<body>
   <!-- nav admin -->
   {% include "formatos/navbaradmin.html" %}
   {% block content %}

    <div class="containter mt-5">
        <h2 class="text-center">Panel de Promociones</h2>

        <div class="container mt-3">
            <form  class="d-flex" id="formBuscarProducto" role="search">
                <input type="text" class="form-control me-2" id="buscarProducto" placeholder="Puede buscar el producto por Nombre o ID" aria-label="Buscar">
                <button class="btn btn-success" type="submit">Buscar</button>
            </form>
            <div id="mensaje" class="mt-3"></div>
        </div>

        <table class="table table-bordered mt-4">
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Nombre del Producto</th>
                    <th>Precio</th>
                    <th>% Descuento</th>
                    <th>Precio con descuento</th>
                    <th>Estado</th>
                </tr>
            </thead>
            <tbody id="tablePromociones">
            </tbody>
        </table>

        <div class="text-center mt-4">
            <button class="btn btn-success" id="btnAplicarCambios">Aplicar Cambios</button>
        </div>
    </div>
    {% endblock %}
    {% include "formatos/footeradmin.html"%}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
   document.addEventListener('DOMContentLoaded', () => {
       const formBuscarProducto = document.getElementById('formBuscarProducto');
       const resultadoProducto = document.getElementById('tablePromociones');
       const mensaje = document.getElementById('mensaje');

       const productos = [
           { id: 'prod-1', nombre: 'Leche Entera 1Lt', precio: 1300, descuento: 9, estado: 'Activa' },
           { id: 'prod-2', nombre: 'Café Tradición 170g', precio: 3500, descuento: 15, estado: 'Inactiva' },
           { id: 'prod-3', nombre: 'Cheetos 300g', precio: 2500, descuento: 5, estado: 'Activa' },
           { id: 'prod-4', nombre: 'Yogurt Frutilla Soprole 1L', precio: 2200, descuento: 0, estado: 'Inactiva' },
           { id: 'prod-5', nombre: 'Arroz Integral 1Kg', precio: 1500, descuento: 0, estado: 'Inactiva' },
       ];

       const renderizarProductos = (productosFiltrados) => {
           resultadoProducto.innerHTML = productosFiltrados.map(producto =>
           `<tr>
               <td>${producto.id}</td>
               <td>${producto.nombre}</td>
               <td>${producto.precio}</td>
               <td><input type="number" class="form-control" value="${producto.descuento}" min="0" max="100"></td>
               <td>${producto.precio - (producto.precio * (producto.descuento / 100))}</td>
               <td>
                   <select class="form-select">
                       <option value="Activa" ${producto.estado === 'Activa' ? 'selected': ''}>Activa</option>
                       <option value="Inactiva" ${producto.estado === 'Inactiva' ? 'selected': ''}>Inactiva</option>
                   </select>
               </td>
           </tr>`).join('');
       };

       renderizarProductos(productos);

       formBuscarProducto.addEventListener('submit', (event) => {
           event.preventDefault();
           const query = document.getElementById('buscarProducto').value.trim().toLowerCase();
           const productosFiltrados = productos.filter(p => p.id.toLowerCase().includes(query) || p.nombre.toLowerCase().includes(query));

           if (productosFiltrados.length > 0) {
               mensaje.innerHTML = '';
               renderizarProductos(productosFiltrados);
           } else {
               mensaje.innerHTML = '<div class="alert alert-danger">Producto no encontrado.</div>';
               resultadoProducto.innerHTML = '';
           }
       });

       document.getElementById('btnAplicarCambios').addEventListener('click', () => {
           alert('Cambios aplicados');
       });
   });
</script>

</body>
</html>